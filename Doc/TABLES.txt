DROP TABLE IF EXISTS Produtos;
DROP TABLE IF EXISTS Localizacoes;
DROP TABLE IF EXISTS Lpns;
DROP TABLE IF EXISTS Usuarios;

CREATE TABLE if not exists Produtos (
    ProdutoId int not null,
    Referencia varchar(255),
    Descricao varchar(255),
    Observacao text,
	PRIMARY KEY (ProdutoId)
);

CREATE TABLE if not exists Localizacoes (
    LocalizacaoId int not null,
    LocalizacaoSuperiorId int,
    Divisao varchar(255),
    Observacao text,
	PRIMARY KEY (LocalizacaoId)
);

CREATE TABLE if not exists Lpns (
    LpnId int not null,
    ProdutoId int,
    Quantidade double(10,3),
    LpnContenedorId int,
    LocalizacaoId int,
	PRIMARY KEY (LpnId),
	FOREIGN KEY (ProdutoId) REFERENCES Produtos(ProdutoId),
	FOREIGN KEY (LocalizacaoId) REFERENCES Localizacoes(LocalizacaoId)
);

CREATE TABLE if not exists Usuarios (
    UsuarioId int not null,
    Apelido varchar(255),
    Senha varchar(255),
    Supervisor bit,
	PRIMARY KEY (UsuarioId)
);

ALTER TABLE Localizacoes 
   ADD FOREIGN KEY (LocalizacaoSuperiorId) REFERENCES Localizacoes(LocalizacaoId);

ALTER TABLE Lpns 
   ADD FOREIGN KEY (LpnContenedorId) REFERENCES Lpns(LpnId);
